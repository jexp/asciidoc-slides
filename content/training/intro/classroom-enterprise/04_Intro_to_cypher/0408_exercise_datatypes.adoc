[canvas-image="./img/coding-sw.jpg"]
== It's your turn!

[role="canvas-caption", position="center"]
It's your turn!

++++
<div class="img-ref">
derivative of <a href="https://www.flickr.com/photos/adikos/4440682278">"Female Typing"</a> by <a href="https://www.flickr.com/photos/adikos/">Adikos</a> / <a href="http://creativecommons.org/licenses/by/2.0/">CC BY</a>
<div>
++++

== More queries

- List all departments of "GraphIT" and their employees.
- Who is working for at least two departments?
- Find all persons with a name starting with an E.
- Through whom/how many persons do Alice and Charlene know each other?
- Explore the database. What labels do exist? How many nodes/relationships are stored?


== Departments of "GraphIT"

[source,cypher,options="step"]
----
MATCH (d:Dept)-[:PARENT*0..]->(o:Org)
OPTIONAL MATCH (h:Human)<-[:EMPLOYEE]->d
WHERE o.name = "GraphIT"
RETURN d.name, collect(h.name) as employees;
----

== Who is working for at least two departments?

[source,cypher,options="step"]
----
MATCH (h:Human)<-[:EMPLOYEE]->(d1:Dept),
h<-[:EMPLOYEE]->(d2:Dept)
RETURN DISTINCT h.name;
----

== Persons with name starting with an E

[source,cypher,options="step"]
----
MATCH (h:Human)
WHERE h.name =~ "E.*"
RETURN h.name;
----

== Connection from Alice to Charlene

[source,cypher,options="step"]
----
MATCH path=(a:Human)-[:EMPLOYEE|LEAD*0..]-(c:Human)
WHERE a.name = "Alice"
  AND c.name = "Charlene"
RETURN 
  length(filter(n IN nodes(path) WHERE "Human" IN LABELS(n)));
----


== Connection from Alice to Charlene

[source,cypher,options="step"]
----
MATCH path=(a:Human)-[:EMPLOYEE|LEAD*0..]-(c:Human)
WHERE a.name = "Alice"
  AND c.name = "Charlene"
RETURN extract(n IN nodes(path) | n.name);
----

== Connection from Alice to Charlene

[source,cypher,options="step"]
----
MATCH path=(a:Human)-[:EMPLOYEE|LEAD*0..]-(c:Human)
WHERE a.name = "Alice"
  AND c.name = "Charlene"
WITH 
  filter(n IN nodes(path) WHERE "Human" IN labels(n)) 
  AS persons
RETURN extract(n IN persons | n.name);
----

[options="step"]
`WITH` allows you to modify/filter result sets



== Explore the database

[source,cypher,options="step"]
----
MATCH (a)-[r]->(b)
WHERE labels(a) <> [] AND labels(b) <> []
RETURN DISTINCT 
  head(labels(a)) AS This, 
  type(r) AS To, 
  head(labels(b)) AS That;
----